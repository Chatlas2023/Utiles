<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz de Actualidad - Noticias Reales</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üì∞</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.4;
            min-height: 100vh;
            padding: 10px;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            height: calc(100vh - 30px);
            display: flex;
            flex-direction: column;
        }

        .screen {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            animation: fadeIn 0.5s ease;
            flex: 1;
            overflow-y: auto;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .active {
            display: flex;
            flex-direction: column;
        }

        h1 {
            text-align: center;
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 24px;
            font-weight: 700;
        }

        /* PANTALLA INICIO COMPACTA */
        #start-screen {
            text-align: center;
            justify-content: center;
            gap: 12px;
        }

        #start-screen p {
            font-size: 15px;
            margin-bottom: 8px;
            color: #555;
        }

        .feature-list {
            margin: 12px 0;
            background: #f8f9fa;
            padding: 12px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .feature {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 16px;
        }

        .feature .icon {
            font-size: 18px;
            margin-right: 10px;
            width: 25px;
            text-align: center;
        }

        .demo-note {
            text-align: center;
            margin-top: 15px;
            padding: 8px;
            background: #fff3cd;
            border-radius: 6px;
            border: 1px solid #ffeaa7;
            font-size: 12px;
        }

        /* PANTALLA QUIZ COMPACTA */
        .quiz-header {
            margin-bottom: 15px;
        }

        .progress {
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 4px;
        }

        .progress-text {
            text-align: center;
            margin-bottom: 10px;
            font-weight: 600;
            color: #7f8c8d;
            font-size: 14px;
        }

        .question-image {
            width: 100%;
            height: 203px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            border: 2px solid white;
            background: #f8f9fa;
                transition: all 0.3s ease; /* Agregar transici√≥n suave */

        }

        .question-text {
            font-size: 15px;
            margin-bottom: 12px;
            font-weight: 600;
            line-height: 1.4;
            color: #2c3e50;
            text-align: center;
            flex-shrink: 0;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
            flex: 1;
            overflow-y: auto;
        }

        .option {
            padding: 12px 14px;
    background: #ffffff; /* era #f8f9fa - ahora blanco puro */
            border: 2px solid #d1d8e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px;
            font-weight: 500;
            flex-shrink: 0;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* agregar sombra para mejor contraste */

        }

        .option:hover {
            background: #f0f8ff;
            transform: translateY(-2px);
                border-color: #3498db; /* agregar borde azul al hover */

        }

        .option.selected {
            background: #3498db;
            color: white;
            border-color: #3498db;
            transform: translateY(-1px);
        }

        .option.correct {
            background: #2ecc71;
            color: white;
            border-color: #2ecc71;
        }

        .option.incorrect {
            background: #e74c3c;
            color: white;
            border-color: #e74c3c;
        }

        /* BOTONES COMPACTOS */
        .button {
            display: block;
            width: 100%;
            padding: 14px;
            background: #2ecc71;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            flex-shrink: 0;
            margin-top: auto;
        }

        .button:hover {
            background: #27ae60;
            transform: translateY(-2px);
        }

        .button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .button.restart {
            background: #3498db;
        }

        .button.restart:hover {
            background: #2980b9;
        }

        .button.share {
            background: #9b59b6;
            margin-top: 10px;
        }

        .button.share:hover {
            background: #8e44ad;
        }

        /* PANTALLA RESULTADOS COMPACTA */
        #result-screen {
            text-align: center;
            justify-content: center;
            gap: 15px;
        }


        .result-message {
            font-size: 15px;
            margin: 15px 0;
            color: #7f8c8d;
            line-height: 1.4;
        }

.result-actions {
    margin: 20px 0;
    display: flex;
    gap: 10px;
}
        .result-actions .button {
    flex: 1;
    margin-top: 0;
}

        /* PANTALLA CARGA COMPACTA */
        .loading {
            text-align: center;
            padding: 30px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            flex: 1;
        }

        .spinner {
            border: 5px solid rgba(52, 152, 219, 0.2);
            border-left-color: #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1.2s linear infinite;
            margin-bottom: 15px;
        }
        /* NUEVO: SECCI√ìN DE NOTICIAS COMPLETAS */
.news-results {
    margin: 20px 0;
    text-align: left;
}

.news-results h3 {
    text-align: center;
    margin-bottom: 15px;
    color: #2c3e50;
    font-size: 18px;
}

.news-item {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 10px;
    margin-bottom: 8px;
    border-left: 4px solid #3498db;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
}
.news-content {
    flex: 1;
}
.news-item:hover {
    background: #e8f4fc;
    transform: translateX(5px);
}

.news-item.correct {
    border-left-color: #2ecc71;
}

.news-item.incorrect {
    border-left-color: #e74c3c;
}

.news-title {
    font-weight: 600;
    color: #2c3e50;
    font-size: 13px;
    line-height: 1.3;
    margin-bottom: 4px;
}

.news-status {
    display: inline-block;
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: 600;
    margin-right: 5px;
}

.news-status.correct {
    background: #d5f4e6;
    color: #27ae60;
}

.news-status.incorrect {
    background: #fdeaea;
    color: #e74c3c;
}

.read-article-btn {
    display: inline-block;
    padding: 4px 10px;
    background: #3498db;
    color: white;
    text-decoration: none;
    border-radius: 6px;
    font-size: 10px;
    font-weight: 600;
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
    white-space: nowrap;
}

.read-article-btn:hover {
    background: #2980b9;
    transform: translateY(-1px);
}

.news-actions {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
}

.read-all-news {
    background: #9b59b6;
    margin-top: 10px;
}

.read-all-news:hover {
    background: #8e44ad;
}

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
            .question-image {
                height: 169px;
            }
            
            .options {
                gap: 6px;
            }
            
            .option {
                padding: 10px 12px;
                font-size: 13px;
            }
            
            .button {
                padding: 14px;
                font-size: 15px;
            }
            
            .score-circle {
                width: 80px;
                height: 80px;
                font-size: 24px;
            }
        }

        @media (max-height: 600px) {
            .screen {
                padding: 15px;
            }
            
            h1 {
                font-size: 22px;
                margin-bottom: 10px;
            }
            
            .question-image {
                height: 143px;
                margin-bottom: 10px;
            }
            
            .question-text {
                font-size: 15px;
                margin-bottom: 10px;
            }
            
            .feature-list {
                padding: 10px;
                margin: 10px 0;
            }
            
            .feature {
                margin: 6px 0;
                font-size: 13px;
            }
        }

        /* Scroll suave para opciones si es necesario */
        .options::-webkit-scrollbar {
            width: 4px;
        }

        .options::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 2px;
        }

        .options::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 2px;
        }

        .options::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Pantalla de inicio -->
<!-- Pantalla de inicio -->
<div id="start-screen" class="screen active">
    <h1>üì∞ Quiz de Actualidad</h1>
    <p>Pon a prueba tus conocimientos con noticias reales</p>
    <div class="feature-list">
        <div class="feature">
            <span class="icon">üåé</span>
            <span>Noticias del mundo.</span>
        </div>
        <div class="feature">
            <span class="icon">üîç</span>
            <span>Noticias en tiempo real</span>
        </div>
        <div class="feature">
            <span class="icon">üéØ</span>
            <span>10 preguntas desafiantes</span>
        </div>
    </div>
    <button id="start-btn" class="button">Comenzar Quiz</button>
</div>
        
        <!-- Pantalla de carga -->
        <div id="loading-screen" class="screen">
            <div class="loading">
                <div class="spinner"></div>
                <p>Cargando noticias actuales...</p>
                <p>Esto puede tomar unos segundos</p>
            </div>
        </div>
        
        <!-- Pantalla de preguntas -->
        <div id="quiz-screen" class="screen">
            <div class="quiz-header">
                <div class="progress-text">Pregunta <span id="current-question">1</span> de 10</div>
                <div class="progress">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>
            </div>
            
            <div class="question-container">
                <img id="question-image" class="question-image" src="" alt="Imagen de la noticia">
                <div id="question-text" class="question-text"></div>
                <div id="options" class="options"></div>
            </div>
            
            <button id="next-btn" class="button" disabled>Siguiente</button>
        </div>
        
        <!-- Pantalla de resultados -->
<div id="result-screen" class="screen">
    
    <div class="result">      
        <!-- NUEVA SECCI√ìN: NOTICIAS COMPLETAS -->
        <div class="news-results">
            <!-- ELIMINAR ESTE T√çTULO -->
            <!-- <h3>üì∞ Resumen de Noticias</h3> -->
            <div id="news-list" class="news-list">
                <!-- Las noticias se cargar√°n aqu√≠ din√°micamente -->
            </div>
        </div>
        
        <div class="result-actions">
            <button id="restart-btn" class="button restart">üîÑ Jugar</button>
            <button id="share-btn" class="button share">üì§ Compartir</button>
        </div>
    </div>
</div>
    </div>
<script>
    // =============================================
    // QUIZ DE ACTUALIDAD - v4.4 - IM√ÅGENES GARANTIZADAS
    // √öltima actualizaci√≥n: 2024-01-15
    // =============================================

    // Variables globales
    let questions = [];
    let currentQuestionIndex = 0;
    let score = 0;
    let selectedOption = null;

    // Elementos del DOM
    let startScreen, loadingScreen, quizScreen, resultScreen;
    let startBtn, nextBtn, restartBtn, shareBtn;
    let questionImage, questionText, optionsContainer;
    let progressBar, currentQuestionElement, scoreValue, scoreText, resultMessage, setupLink;

    // Funci√≥n para obtener fecha actual
    function getCurrentDate() {
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    }

    // Funci√≥n para inicializar elementos DOM con validaci√≥n
    function initializeDOMElements() {
        console.log('üîç v4.4 - Inicializando elementos DOM...');
        
        // Pantallas
        startScreen = document.getElementById('start-screen');
        loadingScreen = document.getElementById('loading-screen');
        quizScreen = document.getElementById('quiz-screen');
        resultScreen = document.getElementById('result-screen');
        
        // Botones
        startBtn = document.getElementById('start-btn');
        nextBtn = document.getElementById('next-btn');
        restartBtn = document.getElementById('restart-btn');
        shareBtn = document.getElementById('share-btn');
        
        // Elementos de preguntas
        questionImage = document.getElementById('question-image');
        questionText = document.getElementById('question-text');
        optionsContainer = document.getElementById('options');
        
        // Elementos de progreso y resultados
        progressBar = document.getElementById('progress-bar');
        currentQuestionElement = document.getElementById('current-question');
        scoreValue = document.getElementById('score-value');
        scoreText = document.getElementById('score-text');
        resultMessage = document.getElementById('result-message');
        setupLink = document.getElementById('setup-link');
        
        // Validar elementos cr√≠ticos
        const criticalElements = [
            { name: 'startScreen', element: startScreen },
            { name: 'loadingScreen', element: loadingScreen },
            { name: 'quizScreen', element: quizScreen },
            { name: 'resultScreen', element: resultScreen },
            { name: 'startBtn', element: startBtn },
            { name: 'nextBtn', element: nextBtn }
        ];

        let missingElements = [];
        criticalElements.forEach(item => {
            if (!item.element) {
                missingElements.push(item.name);
            }
        });

        if (missingElements.length > 0) {
            console.error('‚ùå v4.4 - Elementos faltantes:', missingElements);
            throw new Error(`Faltan elementos cr√≠ticos: ${missingElements.join(', ')}`);
        }
        
        console.log('‚úÖ v4.4 - Todos los elementos DOM inicializados correctamente');
    }

    // Funci√≥n para configurar event listeners
// Funci√≥n para configurar event listeners
function setupEventListeners() {
    console.log('üéØ v4.4 - Configurando event listeners...');
    
    if (startBtn) {
        startBtn.addEventListener('click', startQuiz);
        console.log('‚úÖ Listener agregado: startBtn');
    }
    
    if (nextBtn) {
        nextBtn.addEventListener('click', nextQuestion);
        console.log('‚úÖ Listener agregado: nextBtn');
    }
    
    if (restartBtn) {
        restartBtn.addEventListener('click', restartQuiz);
        console.log('‚úÖ Listener agregado: restartBtn');
    }
    
    if (shareBtn) {
        shareBtn.addEventListener('click', shareResults);
        console.log('‚úÖ Listener agregado: shareBtn');
    }
    
    if (setupLink) {
        setupLink.addEventListener('click', showSetupGuide);
        console.log('‚úÖ Listener agregado: setupLink');
    }
    
    console.log('‚úÖ v4.4 - Todos los event listeners configurados');
}

    // üîç FUNCI√ìN PARA VERIFICACI√ìN R√ÅPIDA DE IM√ÅGENES
// üîç FUNCI√ìN PARA VERIFICACI√ìN R√ÅPIDA DE IM√ÅGENES Y MEDIOS
function quickImageCheck(imageUrl) {
    if (!imageUrl || !imageUrl.startsWith('http')) {
        return false;
    }
    
    // Lista de dominios confiables DE ARGENTINA Y EE.UU.
    const trustedDomains = [
        // Argentina
        'infobae.com', 'clarin.com', 'lanacion.com', 'lanacion.com.ar',
        'pagina12.com.ar', 'ambito.com', 'cronista.com', 'perfil.com',
        'telam.com.ar', 'diariopopular.com.ar', 'lavoz.com.ar',
        'losandes.com.ar', 'lmneuquen.com.ar', 'rionegro.com.ar',
        
        // Estados Unidos (medios en espa√±ol o internacionales)
        'cnn.com', 'cnnespanol.cnn.com', 'bbc.com', 'bbc.co.uk',
        'reuters.com', 'apnews.com', 'bloomberg.com', 'wsj.com',
        'nytimes.com', 'washingtonpost.com', 'usatoday.com',
        'nbcnews.com', 'abcnews.go.com', 'cbsnews.com', 'foxnews.com',
        
        // Medios internacionales que cubren noticias de AR/US
        'france24.com', 'dw.com', 'euronews.com', 'aljazeera.com'
    ];
    
    // Lista de dominios problem√°ticos o no deseados
    const blockedDomains = [
        'placeholder', 'default', 'placehold.co', 'dummyimage.com',
        'via.placeholder.com', 'example.com', 'test.com',
        // Medios de otros pa√≠ses que no queremos
        'eluniversal.com.mx', 'elmundo.es', 'elpa√≠s.com', 'abc.es',
        'lavanguardia.com', 'elperiodico.com', '20minutos.es',
        'rtve.es', 'antena3.com', 'telecinco.es', 'lasexta.com',
        'record.com.mx', 'milenio.com', 'excelsior.com.mx',
        'granma.cu', 'telesurtv.net', 'elpais.com' // espec√≠ficamente El Pa√≠s
    ];
    
    const isTrusted = trustedDomains.some(domain => imageUrl.toLowerCase().includes(domain));
    const isBlocked = blockedDomains.some(domain => imageUrl.toLowerCase().includes(domain));
    
    // Verificar extensi√≥n de archivo de imagen
    const imageExtensions = ['.jpg', '.jpeg', '.png', '.webp', '.gif', '.bmp'];
    const hasImageExtension = imageExtensions.some(ext => imageUrl.toLowerCase().includes(ext));
    
    // Verificar patrones comunes de CDN de im√°genes
    const hasImagePatterns = imageUrl.includes('/images/') || 
                           imageUrl.includes('/img/') || 
                           imageUrl.includes('/fotos/') ||
                           imageUrl.includes('/photo/') ||
                           imageUrl.includes('/imagenes/') ||
                           imageUrl.includes('/foto/') ||
                           imageUrl.includes('/photogallery/');
    
    return !isBlocked && (isTrusted || hasImageExtension || hasImagePatterns);
}
    // üîç FUNCI√ìN PARA FILTRAR MEDIOS POR PA√çS
function filterByCountryAndSource(articles) {
    console.log('üåé Filtrando medios por Argentina y EE.UU....');
    
    // Medios de Argentina
    const argentinaMedia = [
        'infobae', 'clarin', 'lanacion', 'p√°gina 12', 'pagina12', '√°mbito',
        'cronista', 'perfil', 't√©lam', 'telam', 'diario popular', 'la voz',
        'los andes', 'lm neuquen', 'r√≠o negro'
    ];
    
    // Medios de Estados Unidos (en espa√±ol o internacionales)
    const usMedia = [
        'cnn', 'bbc', 'reuters', 'associated press', 'ap news', 'bloomberg',
        'wall street journal', 'new york times', 'washington post', 'usa today',
        'nbc', 'abc', 'cbs', 'fox news', 'france 24', 'dw', 'euronews', 'al jazeera'
    ];
    
    const filteredArticles = articles.filter(article => {
        if (!article.source || !article.source.name) return false;
        
        const sourceName = article.source.name.toLowerCase();
        const articleTitle = article.title ? article.title.toLowerCase() : '';
        const articleUrl = article.url ? article.url.toLowerCase() : '';
        
        // Verificar si es de Argentina
        const isFromArgentina = argentinaMedia.some(media => 
            sourceName.includes(media) || 
            articleTitle.includes('argentina') ||
            articleUrl.includes('.com.ar')
        );
        
        // Verificar si es de EE.UU.
        const isFromUS = usMedia.some(media => 
            sourceName.includes(media) ||
            articleTitle.includes('estados unidos') ||
            articleTitle.includes('ee.uu.') ||
            articleTitle.includes('eeuu') ||
            articleUrl.includes('.com')
        );
        
        return isFromArgentina || isFromUS;
    });
    
    console.log(`üìä Despu√©s del filtro por pa√≠s: ${filteredArticles.length} art√≠culos`);
    return filteredArticles;
}

    // Funci√≥n principal para cargar noticias reales
// Funci√≥n principal para cargar noticias reales
// Funci√≥n principal para cargar noticias reales
// Funci√≥n principal para cargar noticias reales
async function loadRealNews() {
    const apiKey = 'cd358617b03acad6467b57dfe9cbdb81';
    
    console.log('üîÑ v4.4 - Cargando noticias EXCLUSIVAS de Argentina y Estados Unidos (sin deportes)...');
    
    try {
        // VARIAR LAS CATEGOR√çAS - EXCLUYENDO DEPORTES
        const categories = ['general', 'world', 'business', 'technology', 'science', 'health', 'entertainment'];
        const randomCategory = categories[Math.floor(Math.random() * categories.length)];
        
        // SOLO ARGENTINA Y ESTADOS UNIDOS
        const countries = ['ar', 'us'];
        const randomCountry = countries[Math.floor(Math.random() * countries.length)];
        
        const proxyUrl = 'https://api.allorigins.win/raw?url=';
        const targetUrl = `https://gnews.io/api/v4/top-headlines?token=${apiKey}&lang=es&max=40&category=${randomCategory}&country=${randomCountry}`;
        
        console.log('üîó URL completa:', proxyUrl + encodeURIComponent(targetUrl));
        console.log(`üéØ Categor√≠a: ${randomCategory}, Pa√≠s: ${randomCountry}`);
        console.log(`üö´ FILTRO: Excluyendo deportes`);
        console.log(`üåé FILTRO: Solo medios de Argentina y EE.UU.`);
        
        const response = await fetch(proxyUrl + encodeURIComponent(targetUrl), {
            method: 'GET',
            headers: {
                'Accept': 'application/json',
            }
        });
        
        if (!response.ok) {
            throw new Error(`Error HTTP: ${response.status} - ${response.statusText}`);
        }
        
        const data = await response.json();
        
        // NUEVO: Debug de la respuesta
        debugApiResponse(data);
        
        console.log('‚úÖ v4.4 - Noticias recibidas correctamente');
        console.log('üìä Cantidad de art√≠culos brutos:', data.articles ? data.articles.length : 0);
        
        if (data.articles && data.articles.length > 0) {
            // üî• NUEVO: FILTRAR PARA EXCLUIR NOTICIAS DE DEPORTES
            const nonSportsArticles = filterOutSports(data.articles);
            
            // LUEGO FILTRAR POR PA√çS/MEDIO
            const countryFilteredArticles = filterByCountryAndSource(nonSportsArticles);
            
            // LUEGO FILTRADO RIGUROSO por im√°genes y t√≠tulos
const articlesWithImages = countryFilteredArticles.filter(article => 
    article.title && 
    article.title.length > 15
);
            
            console.log(`üìä Art√≠culos despu√©s de todos los filtros: ${articlesWithImages.length}`);
            
            if (articlesWithImages.length >= 3) {
                const generatedQuestions = generateQuestionsFromArticles(articlesWithImages);
                console.log(`‚úÖ v4.4 - Preguntas generadas (sin deportes): ${generatedQuestions.length}`);
                return generatedQuestions;
            } else {
                console.log('üîÑ No hay suficientes art√≠culos filtrados, intentando con el otro pa√≠s...');
                return await loadAlternativeCountryNews(apiKey, randomCountry);
            }
        } else {
            throw new Error('No se encontraron noticias en la respuesta de la API');
        }
    } catch (error) {
        console.error('‚ùå v4.4 - Error cargando noticias:', error);
        throw new Error('No se pudieron cargar noticias (sin deportes) de Argentina y Estados Unidos. Intenta m√°s tarde.');
    }
}
    // üîç FUNCI√ìN PARA EXCLUIR NOTICIAS DE DEPORTES
function filterOutSports(articles) {
    console.log('üö´ Filtrando y excluyendo noticias de deportes...');
    
    const sportsKeywords = [
        // Deportes en general
        'f√∫tbol', 'futbol', 'football', 'deporte', 'deportes', 'deportivo', 'deportiva',
        'partido', 'jugador', 'equipo', 'liga', 'campeonato', 'torneo', 'competencia',
        // Deportes espec√≠ficos
        'f√∫tbol', 'futbol', 'futbol√≠stico', 'futbolera', 'futbolero',
        'b√°squet', 'basquet', 'baloncesto', 'basketball',
        'tenis', 'voleibol', 'v√≥ley', 'rugby', 'hockey', 'golf',
        'boxeo', 'mma', 'ufc', 'formula 1', 'f1', 'automovilismo',
        'ciclismo', 'atletismo', 'nataci√≥n', 'ol√≠mpico', 'olimpico',
        // Equipos y competiciones
        'champions', 'libertadores', 'copa', 'supercopa', 'mundial',
        'nba', 'nfl', 'mlb', 'nhl', 'mls'
    ];
    
    const filteredArticles = articles.filter(article => {
        if (!article.title) return true;
        
        const title = article.title.toLowerCase();
        const description = article.description ? article.description.toLowerCase() : '';
        
        // Verificar si el t√≠tulo contiene palabras clave de deportes
        const isSportsRelated = sportsKeywords.some(keyword => 
            title.includes(keyword) || description.includes(keyword)
        );
        
        if (isSportsRelated) {
            console.log(`üö´ Excluido por deportes: "${article.title.substring(0, 60)}..."`);
            return false;
        }
        
        return true;
    });
    
    console.log(`üìä Despu√©s de excluir deportes: ${filteredArticles.length} art√≠culos`);
    return filteredArticles;
}
    // Funci√≥n para cargar noticias del pa√≠s alternativo
// Funci√≥n para cargar noticias del pa√≠s alternativo
async function loadAlternativeCountryNews(apiKey, excludedCountry) {
    console.log('üîÑ Intentando con el pa√≠s alternativo (sin deportes)...');
    
    // Determinar el pa√≠s alternativo
    const countries = ['ar', 'us'];
    const alternativeCountry = countries.find(country => country !== excludedCountry);
    
    // CATEGOR√çAS SIN DEPORTES
    const categories = ['general', 'world', 'business', 'technology', 'science', 'health'];
    const randomCategory = categories[Math.floor(Math.random() * categories.length)];
    
    const proxyUrl = 'https://api.allorigins.win/raw?url=';
    const targetUrl = `https://gnews.io/api/v4/top-headlines?token=${apiKey}&lang=es&max=40&category=${randomCategory}&country=${alternativeCountry}`;
    
    console.log(`üîÑ Pa√≠s alternativo: ${alternativeCountry}, Categor√≠a: ${randomCategory} (sin deportes)`);
    
    const response = await fetch(proxyUrl + encodeURIComponent(targetUrl));
    const data = await response.json();
    
    if (data.articles && data.articles.length > 0) {
        // APLICAR FILTRO DE DEPORTES
        const nonSportsArticles = filterOutSports(data.articles);
        
const articlesWithImages = nonSportsArticles.filter(article => 
    article.title && 
    article.title.length > 15
);
        
        console.log(`üìä Art√≠culos con im√°genes v√°lidas (${alternativeCountry}, sin deportes): ${articlesWithImages.length}`);
        
        if (articlesWithImages.length >= 3) {
            return generateQuestionsFromArticles(articlesWithImages);
        }
    }
    
    throw new Error('No se pudieron cargar noticias con im√°genes v√°lidas (sin deportes) de Argentina ni Estados Unidos');
}

    // Generar preguntas a partir de art√≠culos reales
// Generar preguntas a partir de art√≠culos reales - VERSI√ìN MEJORADA PARA 10 PREGUNTAS
// Generar preguntas a partir de art√≠culos reales
function generateQuestionsFromArticles(articles) {
    console.log('üìù v4.4 - Procesando art√≠culos reales para 10 preguntas...');
    
    // MEZCLAR LOS ART√çCULOS antes de filtrar
    const shuffledArticles = [...articles];
    for (let i = shuffledArticles.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffledArticles[i], shuffledArticles[j]] = [shuffledArticles[j], shuffledArticles[i]];
    }
    
    // VERIFICACI√ìN RIGUROSA de im√°genes y t√≠tulos - TOMAR HASTA 10 ART√çCULOS
    const validArticles = [];
    
    for (const article of shuffledArticles) {
        if (validArticles.length >= 10) break;
        
const imageCheck = article.image && article.image.startsWith('http');
const titleCheck = article.title && 
                  article.title.length > 15 &&
                  !article.title.includes('undefined');
        
        // NUEVO: Verificar que tenga URL
        const urlCheck = article.url && article.url.startsWith('http');
        
if (titleCheck && urlCheck) {
            console.log(`‚úÖ Art√≠culo v√°lido: "${article.title.substring(0, 50)}..."`);
            console.log(`   üñºÔ∏è Imagen: ${article.image}`);
            console.log(`   üîó URL: ${article.url}`);
            validArticles.push(article);
        } else {
            console.log(`‚ùå Art√≠culo descartado: "${article.title?.substring(0, 50)}..."`);
            console.log(`   üìä Estado - Imagen: ${imageCheck ? '‚úÖ' : '‚ùå'}, T√≠tulo: ${titleCheck ? '‚úÖ' : '‚ùå'}, URL: ${urlCheck ? '‚úÖ' : '‚ùå'}`);
        }
    }
    
    console.log(`‚úÖ v4.4 - Art√≠culos v√°lidos encontrados: ${validArticles.length}`);
    
    // Si no hay suficientes art√≠culos, lanzar error
    if (validArticles.length < 3) {
        throw new Error(`Solo se encontraron ${validArticles.length} art√≠culos con im√°genes y URLs v√°lidas`);
    }
    
    return validArticles.slice(0, 10).map((article, index) => {
        // Crear opciones incorrectas de otros art√≠culos VERIFICADOS
        const otherArticles = validArticles.filter((_, i) => i !== index);
        
        // MEZCLAR LOS ART√çCULOS PARA OPCIONES INCORRECTAS
        const shuffledOthers = [...otherArticles];
        for (let i = shuffledOthers.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffledOthers[i], shuffledOthers[j]] = [shuffledOthers[j], shuffledOthers[i]];
        }

        const incorrectOptions = [];
        const usedTitles = new Set();

        // Tomar 2 t√≠tulos de otros art√≠culos como opciones incorrectas
        for (let i = 0; i < shuffledOthers.length && incorrectOptions.length < 2; i++) {
let wrongTitle = shuffledOthers[i].title;
wrongTitle = cleanTitle(wrongTitle);
if (wrongTitle.length > 50) {
    wrongTitle = wrongTitle.substring(0, 67) + '...';
}
            
            if (!usedTitles.has(wrongTitle)) {
                incorrectOptions.push(wrongTitle);
                usedTitles.add(wrongTitle);
            }
        }
        
        // Preparar t√≠tulo correcto
let correctTitle = cleanTitle(article.title);
if (correctTitle.length > 50) {
    correctTitle = correctTitle.substring(0, 67) + '...';
}
        // Mezclar opciones
        const options = [correctTitle, ...incorrectOptions];
        shuffleArray(options);
        
        const correctAnswerIndex = options.indexOf(correctTitle);
        
        console.log(`‚ùì v4.4 - Pregunta ${index + 1}: "${correctTitle.substring(0, 50)}..."`);
        console.log(`   üñºÔ∏è Imagen: ${article.image}`);
        console.log(`   üîó URL: ${article.url}`);
        
        return {
            question: "¬øCu√°l es el titular correcto para esta noticia?",
            image: article.image,
            options: options,
            correctAnswer: correctAnswerIndex,
            source: article.source?.name || "Medios Internacionales",
            hasValidImage: true,
            // NUEVO: Guardar informaci√≥n completa del art√≠culo
            articleUrl: article.url,
            fullTitle: cleanTitle(article.title),
            userAnswer: null,
            isCorrect: null
        };
    });
}

    // Limpiar t√≠tulo de la noticia
    function cleanTitle(title) {
        return title
            .replace(/\[.*?\]/g, '')
            .replace(/\(.*?\)/g, '')
            .replace(/ - .*$/, '')
            .replace(/\.$/, '')
            .trim();
    }

    // Funci√≥n para mezclar array
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // Iniciar el quiz
    async function startQuiz() {
        console.log('üöÄ v4.4 - Iniciando quiz con noticias reales...');
        
        if (!startScreen || !loadingScreen || !quizScreen) {
            console.error('‚ùå v4.4 - Error: Pantallas no inicializadas');
            return;
        }
        
        startScreen.classList.remove('active');
        loadingScreen.classList.add('active');
        
        // Reiniciar variables
        currentQuestionIndex = 0;
        score = 0;
        selectedOption = null;
        
        try {
            await loadQuestions();
            loadingScreen.classList.remove('active');
            quizScreen.classList.add('active');
            showQuestion();
        } catch (error) {
            console.error('‚ùå v4.4 - Error cr√≠tico:', error);
            if (loadingScreen) loadingScreen.classList.remove('active');
            if (startScreen) startScreen.classList.add('active');
            alert('‚ùå No se pudieron cargar noticias reales en este momento. El servicio puede estar temporalmente no disponible. Intenta m√°s tarde.');
        }
    }

    // Cargar preguntas
    async function loadQuestions() {
        console.log('üì° v4.4 - Conectando con API de noticias...');
        questions = await loadRealNews();
        
        if (questions.length === 0) {
            throw new Error('No se pudieron generar preguntas desde la API');
        }
        
        shuffleArray(questions);
        console.log(`‚úÖ v4.4 - ${questions.length} preguntas reales cargadas exitosamente`);
    }

    // Mostrar la pregunta actual
    function showQuestion() {
        if (!questions[currentQuestionIndex]) {
            console.error('‚ùå v4.4 - Error: No hay pregunta para mostrar');
            return;
        }
        
        const question = questions[currentQuestionIndex];
        
        console.log(`üìÑ v4.4 - Mostrando noticia real ${currentQuestionIndex + 1}`);
        
        // Validar y establecer elementos
        if (questionImage) {
            questionImage.src = question.image;
            questionImage.alt = "Imagen de la noticia real";
            questionImage.onerror = function() {
                console.log('üñºÔ∏è v4.4 - Imagen no disponible, usando placeholder mejorado');
                this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjhmOGY4Ii8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iODAiIHI9IjMwIiBmaWxsPSIjZGRkIi8+PHJlY3QgeD0iMTUwIiB5PSIxMjAiIHdpZHRoPSIxMDAiIGhlaWdodD0iMTUiIHJ4PSI3IiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iMjAwIiB5PSIxODAiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+Tm90aWNpYSByZWFsPC90ZXh0Pjwvc3ZnPg==';
                this.alt = "Imagen de noticia no disponible";
            };
        }
        
        if (questionText) {
            questionText.textContent = question.question;
        }
        
if (optionsContainer) {
    optionsContainer.innerHTML = '';
    question.options.forEach((option, index) => {
        const optionElement = document.createElement('div');
        optionElement.className = 'option';
        optionElement.textContent = option;
        optionElement.dataset.index = index;
        optionElement.addEventListener('click', selectOption);
        optionsContainer.appendChild(optionElement);
    });
}
        
        // Actualizar progreso
        if (progressBar) {
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
        }
        
        if (currentQuestionElement) {
            currentQuestionElement.textContent = currentQuestionIndex + 1;
        }
        
        // Reiniciar estado
selectedOption = null;
if (nextBtn) {
    nextBtn.disabled = true;
    nextBtn.textContent = currentQuestionIndex < questions.length - 1 ? "Siguiente" : "Ver resultados";
}
    }

    // Seleccionar una opci√≥n
// Seleccionar una opci√≥n - VERSI√ìN MEJORADA PARA PERMITIR CAMBIOS
function selectOption(e) {
    const options = document.querySelectorAll('.option');
    
    // Remover selecci√≥n anterior de todas las opciones
    options.forEach(option => option.classList.remove('selected'));
    
    // Agregar selecci√≥n a la opci√≥n clickeada
    e.target.classList.add('selected');
    selectedOption = parseInt(e.target.dataset.index);
    
    if (nextBtn) {
        nextBtn.disabled = false;
    }
}

    // Pasar a la siguiente pregunta
// Pasar a la siguiente pregunta
// Pasar a la siguiente pregunta
function nextQuestion() {
    const correctAnswer = questions[currentQuestionIndex].correctAnswer;
    const options = document.querySelectorAll('.option');
    
    // Guardar la respuesta del usuario
    questions[currentQuestionIndex].userAnswer = selectedOption;
    questions[currentQuestionIndex].isCorrect = (selectedOption === correctAnswer);
    
    // Mostrar feedback visual
    options[correctAnswer].classList.add('correct');
    if (selectedOption !== correctAnswer) {
        options[selectedOption].classList.add('incorrect');
    } else {
        score++;
    }
    
    // Deshabilitar opciones despu√©s de confirmar
    options.forEach(option => {
        option.style.pointerEvents = 'none';
    });
    
    // Deshabilitar el bot√≥n siguiente temporalmente
    if (nextBtn) {
        nextBtn.disabled = true;
    }
    
    // Avanzar despu√©s de delay
    setTimeout(() => {
        currentQuestionIndex++;
        if (currentQuestionIndex < questions.length) {
            showQuestion();
        } else {
            showResults();
        }
    }, 1500);
}
    // Mostrar resultados
function showResults() {
    if (quizScreen) quizScreen.classList.remove('active');
    if (resultScreen) resultScreen.classList.add('active');
    
    // MOSTRAR LAS NOTICIAS
    showNewsResults();
    console.log(`üéØ v4.4 - Quiz completado con noticias reales. Puntuaci√≥n: ${score}/${questions.length}`);
}
    // Mostrar lista de noticias con opci√≥n de leer art√≠culos completos
// Mostrar lista de noticias con opci√≥n de leer art√≠culos completos
function showNewsResults() {
    const newsList = document.getElementById('news-list');
    if (!newsList) return;
    
    newsList.innerHTML = '';
    
    questions.forEach((question, index) => {
        const newsItem = document.createElement('div');
        newsItem.className = `news-item ${question.isCorrect ? 'correct' : 'incorrect'}`;
        
        const status = question.isCorrect ? '‚úÖ OK' : '‚ùå Incorrecta';
        const statusClass = question.isCorrect ? 'correct' : 'incorrect';
        
        // Verificar si la URL es v√°lida
        const hasValidUrl = question.articleUrl && 
                           question.articleUrl.startsWith('http') && 
                           question.articleUrl !== 'undefined';
        
        newsItem.innerHTML = `
            <div class="news-content">
<div class="news-title">${question.fullTitle.length > 50 ? question.fullTitle.substring(0, 47) + '...' : question.fullTitle}</div>
</div>
            <div class="news-actions">
                <span class="news-status ${statusClass}">${status}</span>
                ${hasValidUrl ? `
                    <a href="${question.articleUrl}" target="_blank" class="read-article-btn">
                        Leer
                    </a>
                ` : '<small style="color: #e74c3c; font-size: 10px;">‚ö†Ô∏è</small>'}
            </div>
        `;
        
        newsList.appendChild(newsItem);
    });
} 
    
// Funci√≥n para debug de la API
function debugApiResponse(data) {
    console.log('üîç DEBUG - Fuentes de noticias encontradas:');
    if (data.articles && data.articles.length > 0) {
        const sources = new Set();
        data.articles.forEach((article, index) => {
            if (article.source && article.source.name) {
                sources.add(article.source.name);
            }
        });
        
        console.log('üì∞ Medios encontrados:', Array.from(sources));
        
        // Mostrar primeros 5 art√≠culos para debug
        data.articles.slice(0, 5).forEach((article, index) => {
            console.log(`üìÑ Art√≠culo ${index + 1}:`);
            console.log(`   üì∞ T√≠tulo: ${article.title}`);
            console.log(`   üè¢ Fuente: ${article.source?.name}`);
            console.log(`   üñºÔ∏è Imagen: ${article.image ? '‚úÖ' : '‚ùå'}`);
            console.log(`   üîó URL: ${article.url}`);
        });
    }
}

    // Reiniciar el quiz
    function restartQuiz() {
        currentQuestionIndex = 0;
        score = 0;
        selectedOption = null;
        if (resultScreen) resultScreen.classList.remove('active');
        if (startScreen) startScreen.classList.add('active');
    }

    // Compartir resultados
    function shareResults() {
        const shareText = `¬°Acabo de completar el Quiz de Actualidad con noticias reales y obtuve ${score}/10! ¬øPuedes superar mi puntuaci√≥n?`;
        
        if (navigator.share) {
            navigator.share({
                title: 'Quiz de Actualidad - Noticias Reales',
                text: shareText,
                url: window.location.href
            });
        } else {
            navigator.clipboard.writeText(shareText).then(() => {
                alert('Resultado copiado. ¬°Comp√°rtelo!');
            });
        }
    }

    // Mostrar informaci√≥n de la API
// Mostrar informaci√≥n de la API
// Mostrar informaci√≥n de la API
function showSetupGuide(e) {
    if (e) e.preventDefault();
    alert(`QUIZ DE ACTUALIDAD v4.4

‚úÖ MODO: NOTICIAS REALES
üåé EXCLUSIVO: Argentina y Estados Unidos
üö´ SIN DEPORTES: F√∫tbol, b√°squet, tenis, etc.
üì∞ MEDIOS: Infobae, Clar√≠n, La Naci√≥n, CNN, BBC, Reuters, etc.
üåê Fuente: GNews API
üìä Preguntas generadas autom√°ticamente
üñºÔ∏è Im√°genes reales garantizadas

El quiz est√° funcionando EXCLUSIVAMENTE con noticias de medios de Argentina y EE.UU., excluyendo deportes.`);
}

// Mostrar informaci√≥n de versi√≥n
function showVersionInfo() {
    const versionInfo = document.getElementById('version-info');
    if (versionInfo) {
        versionInfo.textContent = `Versi√≥n: 4.4 | Noticias AR/US | Sin deportes | API: GNews`;
    }
    console.log('üîç QUIZ DE ACTUALIDAD - v4.4 - NOTICIAS ARGENTINA Y EE.UU. (SIN DEPORTES)');
    console.log('üìÖ √öltima actualizaci√≥n: 2024-01-15');
    console.log('üåé Fuente: GNews API (Argentina y Estados Unidos)');
    console.log('üö´ FILTRO: Excluyendo noticias deportivas');
    console.log('‚úÖ MODO: Noticias reales en tiempo real');
    console.log('üñºÔ∏è GARANT√çA: Todas las preguntas tienen im√°genes v√°lidas');
    console.log('üöÄ Script cargado correctamente');
}

    // Inicializar aplicaci√≥n
    function initializeApp() {
        try {
            console.log('üöÄ v4.4 - Inicializando aplicaci√≥n...');
            initializeDOMElements();
            setupEventListeners();
            showVersionInfo();
            console.log('‚úÖ v4.4 - Aplicaci√≥n inicializada correctamente');
        } catch (error) {
            console.error('‚ùå v4.4 - Error inicializando aplicaci√≥n:', error);
            alert('Error al cargar la aplicaci√≥n. Verifica la consola para m√°s detalles.');
        }
    }

    // Inicializar cuando el DOM est√© listo
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üìÑ DOM cargado, iniciando aplicaci√≥n...');
        initializeApp();
    });
</script>
</body>
</html>
